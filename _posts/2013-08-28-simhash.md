--- 
layout: post 
title: "海量数据相似度计算之simhash和海明距离" 
date: '2013-08-28T14:52:00.000+08:00' 
author: Wenh Q
tags:
modified\_time: '2013-08-28T14:52:03.678+08:00' 
blogger\_id: tag:blogger.com,1999:blog-4961947611491238191.post-8574113555819689284
blogger\_orig\_url: http://binaryware.blogspot.com/2013/08/simhash.html
---
<div style="margin: 10px; padding: 5px;">

<div style="font-size: 18px;">

[

海量数据相似度计算之simhash和海明距离](http://blog.jobbole.com/46839/)

</div>

<div style="font-size: 13px;">

Via [博客 - 伯乐在线](http://blog.jobbole.com/)

</div>

</div>

<div style="font-size: 13px; padding: 15px 0 10px 10px;">

通过 采集系统
我们采集了大量文本数据，但是文本中有很多重复数据影响我们对于结果的分析。分析前我们需要对这些数据去除重复，如何选择和设计文本的去重算法？常见的有余弦夹角算法、欧式距离、Jaccard相似度、最长公共子串、编辑距离等。

[海量数据相似度计算之simhash和海明距离](http://blog.jobbole.com/46839/)，首发于[博客
- 伯乐在线](http://blog.jobbole.com/)。



<span
style="background-color: white; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px;">原文出处： </span>[严澜（@观澜而索源）](http://www.lanceyan.com/tech/arch/simhash_hamming_distance_similarity.html)



<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

通过 [采集系统 ](http://blog.jobbole.com/46673/)我们采集了大量文本数据，但是文本中有很多重复数据影响我们对于结果的分析。分析前我们需要对这些数据去除重复，如何选择和设计文本的去重算法？常见的有余弦夹角算法、欧式距离、Jaccard相似度、最长公共子串、编辑距离等。这些算法对于待比较的文本数据不多时还比较好用，如果我们的爬虫每天采集的数据以千万计算，我们如何对于这些海量千万级的数据进行高效的合并去重。最简单的做法是拿着待比较的文本和数据库中所有的文本比较一遍如果是重复的数据就标示为重复。看起来很简单，我们来做个测试，就拿最简单的两个数据使用Apache提供的
Levenshtein for 循环100w次计算这两个数据的相似度。代码结果如下：

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin: 0px; padding: 0px;">

<div id="highlighter_611214" class="syntaxhighlighter notranslate c"
style="border: 0px; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-size: 12px !important; margin: 1em 0px !important; overflow-x: auto !important; overflow-y: hidden !important; padding: 1px !important; position: relative !important; width: 620px;">

+--------------------------------------+--------------------------------------+
| <div                                 | <div class="container"               |
| class="line number1 index0 alt2"     | style="background-image: none !impor |
| style="background-image: none !impor | tant; border-bottom-left-radius: 0px |
| tant; border-bottom-left-radius: 0px |  !important; border-bottom-right-rad |
|  !important; border-bottom-right-rad | ius: 0px !important; border-top-left |
| ius: 0px !important; border-right-co | -radius: 0px !important; border-top- |
| lor: rgb(108, 226, 108) !important;  | right-radius: 0px !important; border |
| border-right-style: solid !important | : 0px !important; bottom: auto !impo |
| ; border-top-left-radius: 0px !impor | rtant; box-sizing: content-box !impo |
| tant; border-top-right-radius: 0px ! | rtant; float: none !important; heigh |
| important; border-width: 0px 3px 0px | t: auto !important; left: auto !impo |
|  0px !important; bottom: auto !impor | rtant; line-height: 1.1em !important |
| tant; box-sizing: content-box !impor | ; margin-bottom: 0px !important; mar |
| tant; float: none !important; height | gin-left: -10px; margin-right: 0px ! |
| : auto !important; left: auto !impor | important; margin-top: 0px !importan |
| tant; line-height: 1.1em !important; | t; min-height: inherit !important; o |
|  margin: 0px !important; min-height: | utline: 0px !important; overflow: vi |
|  inherit !important; outline: 0px !i | sible !important; padding: 0px !impo |
| mportant; overflow: visible !importa | rtant; position: relative !important |
| nt; padding: 0px 0.5em 0px 1em !impo | ; right: auto !important; top: auto  |
| rtant; position: static !important;  | !important; vertical-align: baseline |
| right: auto !important; text-align:  |  !important; width: 640px;">         |
| right !important; top: auto !importa |                                      |
| nt; vertical-align: baseline !import | <div                                 |
| ant; white-space: pre !important; wi | class="line number1 index0 alt2"     |
| dth: auto !important;">              | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
| 1                                    |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
| </div>                               | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
| <div                                 | : 0px !important; bottom: auto !impo |
| class="line number2 index1 alt1"     | rtant; box-sizing: content-box !impo |
| style="background-image: none !impor | rtant; float: none !important; heigh |
| tant; border-bottom-left-radius: 0px | t: auto !important; left: auto !impo |
|  !important; border-bottom-right-rad | rtant; line-height: 1.1em !important |
| ius: 0px !important; border-right-co | ; margin: 0px !important; min-height |
| lor: rgb(108, 226, 108) !important;  | : inherit !important; outline: 0px ! |
| border-right-style: solid !important | important; overflow: visible !import |
| ; border-top-left-radius: 0px !impor | ant; padding: 0px 1em !important; po |
| tant; border-top-right-radius: 0px ! | sition: static !important; right: au |
| important; border-width: 0px 3px 0px | to !important; top: auto !important; |
|  0px !important; bottom: auto !impor |  vertical-align: baseline !important |
| tant; box-sizing: content-box !impor | ; white-space: pre !important; width |
| tant; float: none !important; height | : auto !important;">                 |
| : auto !important; left: auto !impor |                                      |
| tant; line-height: 1.1em !important; | `String s1 = `{.c .plain             |
|  margin: 0px !important; min-height: | style="background-image: none !impor |
|  inherit !important; outline: 0px !i | tant; border-bottom-left-radius: 0px |
| mportant; overflow: visible !importa |  !important; border-bottom-right-rad |
| nt; padding: 0px 0.5em 0px 1em !impo | ius: 0px !important; border-top-left |
| rtant; position: static !important;  | -radius: 0px !important; border-top- |
| right: auto !important; text-align:  | right-radius: 0px !important; border |
| right !important; top: auto !importa | : 0px !important; bottom: auto !impo |
| nt; vertical-align: baseline !import | rtant; box-sizing: content-box !impo |
| ant; white-space: pre !important; wi | rtant; float: none !important; font- |
| dth: auto !important;">              | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
| 2                                    | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
| </div>                               | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
| <div                                 | important; outline: 0px !important;  |
| class="line number3 index2 alt2"     | overflow: visible !important; paddin |
| style="background-image: none !impor | g: 0px !important; position: static  |
| tant; border-bottom-left-radius: 0px | !important; right: auto !important;  |
|  !important; border-bottom-right-rad | top: auto !important; vertical-align |
| ius: 0px !important; border-right-co | : baseline !important; width: auto ! |
| lor: rgb(108, 226, 108) !important;  | important;"}`"你妈妈喊你回家吃饭哦，回家罗回家罗"`{.c |
| border-right-style: solid !important |                                      |
| ; border-top-left-radius: 0px !impor | .string                              |
| tant; border-top-right-radius: 0px ! | style="background-image: none !impor |
| important; border-width: 0px 3px 0px | tant; border-bottom-left-radius: 0px |
|  0px !important; bottom: auto !impor |  !important; border-bottom-right-rad |
| tant; box-sizing: content-box !impor | ius: 0px !important; border-top-left |
| tant; float: none !important; height | -radius: 0px !important; border-top- |
| : auto !important; left: auto !impor | right-radius: 0px !important; border |
| tant; line-height: 1.1em !important; | : 0px !important; bottom: auto !impo |
|  margin: 0px !important; min-height: | rtant; box-sizing: content-box !impo |
|  inherit !important; outline: 0px !i | rtant; color: blue !important; float |
| mportant; overflow: visible !importa | : none !important; font-family: Cons |
| nt; padding: 0px 0.5em 0px 1em !impo | olas, 'Bitstream Vera Sans Mono', 'C |
| rtant; position: static !important;  | ourier New', Courier, monospace !imp |
| right: auto !important; text-align:  | ortant; height: auto !important; lef |
| right !important; top: auto !importa | t: auto !important; line-height: 1.1 |
| nt; vertical-align: baseline !import | em !important; margin: 0px !importan |
| ant; white-space: pre !important; wi | t; min-height: inherit !important; o |
| dth: auto !important;">              | utline: 0px !important; overflow: vi |
|                                      | sible !important; padding: 0px !impo |
| 3                                    | rtant; position: static !important;  |
|                                      | right: auto !important; top: auto !i |
| </div>                               | mportant; vertical-align: baseline ! |
|                                      | important; width: auto !important;"} |
| <div                                 | `;`{.c .plain                        |
| class="line number4 index3 alt1"     | style="background-image: none !impor |
| style="background-image: none !impor | tant; border-bottom-left-radius: 0px |
| tant; border-bottom-left-radius: 0px |  !important; border-bottom-right-rad |
|  !important; border-bottom-right-rad | ius: 0px !important; border-top-left |
| ius: 0px !important; border-right-co | -radius: 0px !important; border-top- |
| lor: rgb(108, 226, 108) !important;  | right-radius: 0px !important; border |
| border-right-style: solid !important | : 0px !important; bottom: auto !impo |
| ; border-top-left-radius: 0px !impor | rtant; box-sizing: content-box !impo |
| tant; border-top-right-radius: 0px ! | rtant; float: none !important; font- |
| important; border-width: 0px 3px 0px | family: Consolas, 'Bitstream Vera Sa |
|  0px !important; bottom: auto !impor | ns Mono', 'Courier New', Courier, mo |
| tant; box-sizing: content-box !impor | nospace !important; height: auto !im |
| tant; float: none !important; height | portant; left: auto !important; line |
| : auto !important; left: auto !impor | -height: 1.1em !important; margin: 0 |
| tant; line-height: 1.1em !important; | px !important; min-height: inherit ! |
|  margin: 0px !important; min-height: | important; outline: 0px !important;  |
|  inherit !important; outline: 0px !i | overflow: visible !important; paddin |
| mportant; overflow: visible !importa | g: 0px !important; position: static  |
| nt; padding: 0px 0.5em 0px 1em !impo | !important; right: auto !important;  |
| rtant; position: static !important;  | top: auto !important; vertical-align |
| right: auto !important; text-align:  | : baseline !important; width: auto ! |
| right !important; top: auto !importa | important;"}                         |
| nt; vertical-align: baseline !import |                                      |
| ant; white-space: pre !important; wi | </div>                               |
| dth: auto !important;">              |                                      |
|                                      | <div                                 |
| 4                                    | class="line number2 index1 alt1"     |
|                                      | style="background-image: none !impor |
| </div>                               | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
| <div                                 | ius: 0px !important; border-top-left |
| class="line number5 index4 alt2"     | -radius: 0px !important; border-top- |
| style="background-image: none !impor | right-radius: 0px !important; border |
| tant; border-bottom-left-radius: 0px | : 0px !important; bottom: auto !impo |
|  !important; border-bottom-right-rad | rtant; box-sizing: content-box !impo |
| ius: 0px !important; border-right-co | rtant; float: none !important; heigh |
| lor: rgb(108, 226, 108) !important;  | t: auto !important; left: auto !impo |
| border-right-style: solid !important | rtant; line-height: 1.1em !important |
| ; border-top-left-radius: 0px !impor | ; margin: 0px !important; min-height |
| tant; border-top-right-radius: 0px ! | : inherit !important; outline: 0px ! |
| important; border-width: 0px 3px 0px | important; overflow: visible !import |
|  0px !important; bottom: auto !impor | ant; padding: 0px 1em !important; po |
| tant; box-sizing: content-box !impor | sition: static !important; right: au |
| tant; float: none !important; height | to !important; top: auto !important; |
| : auto !important; left: auto !impor |  vertical-align: baseline !important |
| tant; line-height: 1.1em !important; | ; white-space: pre !important; width |
|  margin: 0px !important; min-height: | : auto !important;">                 |
|  inherit !important; outline: 0px !i |                                      |
| mportant; overflow: visible !importa | `            `{.c .spaces            |
| nt; padding: 0px 0.5em 0px 1em !impo | style="background-image: none !impor |
| rtant; position: static !important;  | tant; border-bottom-left-radius: 0px |
| right: auto !important; text-align:  |  !important; border-bottom-right-rad |
| right !important; top: auto !importa | ius: 0px !important; border-top-left |
| nt; vertical-align: baseline !import | -radius: 0px !important; border-top- |
| ant; white-space: pre !important; wi | right-radius: 0px !important; border |
| dth: auto !important;">              | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
| 5                                    | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
| </div>                               | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
| <div                                 | portant; left: auto !important; line |
| class="line number6 index5 alt1"     | -height: 1.1em !important; margin: 0 |
| style="background-image: none !impor | px !important; min-height: inherit ! |
| tant; border-bottom-left-radius: 0px | important; outline: 0px !important;  |
|  !important; border-bottom-right-rad | overflow: visible !important; paddin |
| ius: 0px !important; border-right-co | g: 0px !important; position: static  |
| lor: rgb(108, 226, 108) !important;  | !important; right: auto !important;  |
| border-right-style: solid !important | top: auto !important; vertical-align |
| ; border-top-left-radius: 0px !impor | : baseline !important; width: auto ! |
| tant; border-top-right-radius: 0px ! | important;"}`String s2 = `{.c        |
| important; border-width: 0px 3px 0px | .plain                               |
|  0px !important; bottom: auto !impor | style="background-image: none !impor |
| tant; box-sizing: content-box !impor | tant; border-bottom-left-radius: 0px |
| tant; float: none !important; height |  !important; border-bottom-right-rad |
| : auto !important; left: auto !impor | ius: 0px !important; border-top-left |
| tant; line-height: 1.1em !important; | -radius: 0px !important; border-top- |
|  margin: 0px !important; min-height: | right-radius: 0px !important; border |
|  inherit !important; outline: 0px !i | : 0px !important; bottom: auto !impo |
| mportant; overflow: visible !importa | rtant; box-sizing: content-box !impo |
| nt; padding: 0px 0.5em 0px 1em !impo | rtant; float: none !important; font- |
| rtant; position: static !important;  | family: Consolas, 'Bitstream Vera Sa |
| right: auto !important; text-align:  | ns Mono', 'Courier New', Courier, mo |
| right !important; top: auto !importa | nospace !important; height: auto !im |
| nt; vertical-align: baseline !import | portant; left: auto !important; line |
| ant; white-space: pre !important; wi | -height: 1.1em !important; margin: 0 |
| dth: auto !important;">              | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
| 6                                    | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
| </div>                               | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
| <div                                 | : baseline !important; width: auto ! |
| class="line number7 index6 alt2"     | important;"}`"你妈妈叫你回家吃饭啦，回家罗回家罗"`{.c |
| style="background-image: none !impor |                                      |
| tant; border-bottom-left-radius: 0px | .string                              |
|  !important; border-bottom-right-rad | style="background-image: none !impor |
| ius: 0px !important; border-right-co | tant; border-bottom-left-radius: 0px |
| lor: rgb(108, 226, 108) !important;  |  !important; border-bottom-right-rad |
| border-right-style: solid !important | ius: 0px !important; border-top-left |
| ; border-top-left-radius: 0px !impor | -radius: 0px !important; border-top- |
| tant; border-top-right-radius: 0px ! | right-radius: 0px !important; border |
| important; border-width: 0px 3px 0px | : 0px !important; bottom: auto !impo |
|  0px !important; bottom: auto !impor | rtant; box-sizing: content-box !impo |
| tant; box-sizing: content-box !impor | rtant; color: blue !important; float |
| tant; float: none !important; height | : none !important; font-family: Cons |
| : auto !important; left: auto !impor | olas, 'Bitstream Vera Sans Mono', 'C |
| tant; line-height: 1.1em !important; | ourier New', Courier, monospace !imp |
|  margin: 0px !important; min-height: | ortant; height: auto !important; lef |
|  inherit !important; outline: 0px !i | t: auto !important; line-height: 1.1 |
| mportant; overflow: visible !importa | em !important; margin: 0px !importan |
| nt; padding: 0px 0.5em 0px 1em !impo | t; min-height: inherit !important; o |
| rtant; position: static !important;  | utline: 0px !important; overflow: vi |
| right: auto !important; text-align:  | sible !important; padding: 0px !impo |
| right !important; top: auto !importa | rtant; position: static !important;  |
| nt; vertical-align: baseline !import | right: auto !important; top: auto !i |
| ant; white-space: pre !important; wi | mportant; vertical-align: baseline ! |
| dth: auto !important;">              | important; width: auto !important;"} |
|                                      | `;`{.c .plain                        |
| 7                                    | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
| </div>                               |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
| <div                                 | -radius: 0px !important; border-top- |
| class="line number8 index7 alt1"     | right-radius: 0px !important; border |
| style="background-image: none !impor | : 0px !important; bottom: auto !impo |
| tant; border-bottom-left-radius: 0px | rtant; box-sizing: content-box !impo |
|  !important; border-bottom-right-rad | rtant; float: none !important; font- |
| ius: 0px !important; border-right-co | family: Consolas, 'Bitstream Vera Sa |
| lor: rgb(108, 226, 108) !important;  | ns Mono', 'Courier New', Courier, mo |
| border-right-style: solid !important | nospace !important; height: auto !im |
| ; border-top-left-radius: 0px !impor | portant; left: auto !important; line |
| tant; border-top-right-radius: 0px ! | -height: 1.1em !important; margin: 0 |
| important; border-width: 0px 3px 0px | px !important; min-height: inherit ! |
|  0px !important; bottom: auto !impor | important; outline: 0px !important;  |
| tant; box-sizing: content-box !impor | overflow: visible !important; paddin |
| tant; float: none !important; height | g: 0px !important; position: static  |
| : auto !important; left: auto !impor | !important; right: auto !important;  |
| tant; line-height: 1.1em !important; | top: auto !important; vertical-align |
|  margin: 0px !important; min-height: | : baseline !important; width: auto ! |
|  inherit !important; outline: 0px !i | important;"}                         |
| mportant; overflow: visible !importa |                                      |
| nt; padding: 0px 0.5em 0px 1em !impo | </div>                               |
| rtant; position: static !important;  |                                      |
| right: auto !important; text-align:  | <div                                 |
| right !important; top: auto !importa | class="line number3 index2 alt2"     |
| nt; vertical-align: baseline !import | style="background-image: none !impor |
| ant; white-space: pre !important; wi | tant; border-bottom-left-radius: 0px |
| dth: auto !important;">              |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
| 8                                    | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
| </div>                               | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
| <div                                 | rtant; float: none !important; heigh |
| class="line number9 index8 alt2"     | t: auto !important; left: auto !impo |
| style="background-image: none !impor | rtant; line-height: 1.1em !important |
| tant; border-bottom-left-radius: 0px | ; margin: 0px !important; min-height |
|  !important; border-bottom-right-rad | : inherit !important; outline: 0px ! |
| ius: 0px !important; border-right-co | important; overflow: visible !import |
| lor: rgb(108, 226, 108) !important;  | ant; padding: 0px 1em !important; po |
| border-right-style: solid !important | sition: static !important; right: au |
| ; border-top-left-radius: 0px !impor | to !important; top: auto !important; |
| tant; border-top-right-radius: 0px ! |  vertical-align: baseline !important |
| important; border-width: 0px 3px 0px | ; white-space: pre !important; width |
|  0px !important; bottom: auto !impor | : auto !important;">                 |
| tant; box-sizing: content-box !impor |                                      |
| tant; float: none !important; height |                                      |
| : auto !important; left: auto !impor |                                      |
| tant; line-height: 1.1em !important; | </div>                               |
|  margin: 0px !important; min-height: |                                      |
|  inherit !important; outline: 0px !i | <div                                 |
| mportant; overflow: visible !importa | class="line number4 index3 alt1"     |
| nt; padding: 0px 0.5em 0px 1em !impo | style="background-image: none !impor |
| rtant; position: static !important;  | tant; border-bottom-left-radius: 0px |
| right: auto !important; text-align:  |  !important; border-bottom-right-rad |
| right !important; top: auto !importa | ius: 0px !important; border-top-left |
| nt; vertical-align: baseline !import | -radius: 0px !important; border-top- |
| ant; white-space: pre !important; wi | right-radius: 0px !important; border |
| dth: auto !important;">              | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
| 9                                    | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
| </div>                               | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
| <div                                 | : inherit !important; outline: 0px ! |
| class="line number10 index9 alt1"    | important; overflow: visible !import |
| style="background-image: none !impor | ant; padding: 0px 1em !important; po |
| tant; border-bottom-left-radius: 0px | sition: static !important; right: au |
|  !important; border-bottom-right-rad | to !important; top: auto !important; |
| ius: 0px !important; border-right-co |  vertical-align: baseline !important |
| lor: rgb(108, 226, 108) !important;  | ; white-space: pre !important; width |
| border-right-style: solid !important | : auto !important;">                 |
| ; border-top-left-radius: 0px !impor |                                      |
| tant; border-top-right-radius: 0px ! | `            `{.c .spaces            |
| important; border-width: 0px 3px 0px | style="background-image: none !impor |
|  0px !important; bottom: auto !impor | tant; border-bottom-left-radius: 0px |
| tant; box-sizing: content-box !impor |  !important; border-bottom-right-rad |
| tant; float: none !important; height | ius: 0px !important; border-top-left |
| : auto !important; left: auto !impor | -radius: 0px !important; border-top- |
| tant; line-height: 1.1em !important; | right-radius: 0px !important; border |
|  margin: 0px !important; min-height: | : 0px !important; bottom: auto !impo |
|  inherit !important; outline: 0px !i | rtant; box-sizing: content-box !impo |
| mportant; overflow: visible !importa | rtant; float: none !important; font- |
| nt; padding: 0px 0.5em 0px 1em !impo | family: Consolas, 'Bitstream Vera Sa |
| rtant; position: static !important;  | ns Mono', 'Courier New', Courier, mo |
| right: auto !important; text-align:  | nospace !important; height: auto !im |
| right !important; top: auto !importa | portant; left: auto !important; line |
| nt; vertical-align: baseline !import | -height: 1.1em !important; margin: 0 |
| ant; white-space: pre !important; wi | px !important; min-height: inherit ! |
| dth: auto !important;">              | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
| 10                                   | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
| </div>                               | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
| <div                                 | important;"}`long`{.c                |
| class="line number11 index10 alt2"   | .color1 .bold                        |
| style="background-image: none !impor | style="background-image: none !impor |
| tant; border-bottom-left-radius: 0px | tant; border-bottom-left-radius: 0px |
|  !important; border-bottom-right-rad |  !important; border-bottom-right-rad |
| ius: 0px !important; border-right-co | ius: 0px !important; border-top-left |
| lor: rgb(108, 226, 108) !important;  | -radius: 0px !important; border-top- |
| border-right-style: solid !important | right-radius: 0px !important; border |
| ; border-top-left-radius: 0px !impor | : 0px !important; bottom: auto !impo |
| tant; border-top-right-radius: 0px ! | rtant; box-sizing: content-box !impo |
| important; border-width: 0px 3px 0px | rtant; color: gray !important; float |
|  0px !important; bottom: auto !impor | : none !important; font-family: Cons |
| tant; box-sizing: content-box !impor | olas, 'Bitstream Vera Sans Mono', 'C |
| tant; float: none !important; height | ourier New', Courier, monospace !imp |
| : auto !important; left: auto !impor | ortant; font-weight: bold !important |
| tant; line-height: 1.1em !important; | ; height: auto !important; left: aut |
|  margin: 0px !important; min-height: | o !important; line-height: 1.1em !im |
|  inherit !important; outline: 0px !i | portant; margin: 0px !important; min |
| mportant; overflow: visible !importa | -height: inherit !important; outline |
| nt; padding: 0px 0.5em 0px 1em !impo | : 0px !important; overflow: visible  |
| rtant; position: static !important;  | !important; padding: 0px !important; |
| right: auto !important; text-align:  |  position: static !important; right: |
| right !important; top: auto !importa |  auto !important; top: auto !importa |
| nt; vertical-align: baseline !import | nt; vertical-align: baseline !import |
| ant; white-space: pre !important; wi | ant; width: auto !important;"}       |
| dth: auto !important;">              | `t1 = System.currentTimeMillis();`{. |
|                                      | c                                    |
| 11                                   | .plain                               |
|                                      | style="background-image: none !impor |
| </div>                               | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
| <div                                 | ius: 0px !important; border-top-left |
| class="line number12 index11 alt1"   | -radius: 0px !important; border-top- |
| style="background-image: none !impor | right-radius: 0px !important; border |
| tant; border-bottom-left-radius: 0px | : 0px !important; bottom: auto !impo |
|  !important; border-bottom-right-rad | rtant; box-sizing: content-box !impo |
| ius: 0px !important; border-right-co | rtant; float: none !important; font- |
| lor: rgb(108, 226, 108) !important;  | family: Consolas, 'Bitstream Vera Sa |
| border-right-style: solid !important | ns Mono', 'Courier New', Courier, mo |
| ; border-top-left-radius: 0px !impor | nospace !important; height: auto !im |
| tant; border-top-right-radius: 0px ! | portant; left: auto !important; line |
| important; border-width: 0px 3px 0px | -height: 1.1em !important; margin: 0 |
|  0px !important; bottom: auto !impor | px !important; min-height: inherit ! |
| tant; box-sizing: content-box !impor | important; outline: 0px !important;  |
| tant; float: none !important; height | overflow: visible !important; paddin |
| : auto !important; left: auto !impor | g: 0px !important; position: static  |
| tant; line-height: 1.1em !important; | !important; right: auto !important;  |
|  margin: 0px !important; min-height: | top: auto !important; vertical-align |
|  inherit !important; outline: 0px !i | : baseline !important; width: auto ! |
| mportant; overflow: visible !importa | important;"}                         |
| nt; padding: 0px 0.5em 0px 1em !impo |                                      |
| rtant; position: static !important;  | </div>                               |
| right: auto !important; text-align:  |                                      |
| right !important; top: auto !importa | <div                                 |
| nt; vertical-align: baseline !import | class="line number5 index4 alt2"     |
| ant; white-space: pre !important; wi | style="background-image: none !impor |
| dth: auto !important;">              | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
| 12                                   | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
| </div>                               | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      |                                      |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number6 index5 alt1"     |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      | `            `{.c .spaces            |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`for`{.c                 |
|                                      | .keyword .bold                       |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; color: rgb(0, 102, 153) !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; font-weight: bol |
|                                      | d !important; height: auto !importan |
|                                      | t; left: auto !important; line-heigh |
|                                      | t: 1.1em !important; margin: 0px !im |
|                                      | portant; min-height: inherit !import |
|                                      | ant; outline: 0px !important; overfl |
|                                      | ow: visible !important; padding: 0px |
|                                      |  !important; position: static !impor |
|                                      | tant; right: auto !important; top: a |
|                                      | uto !important; vertical-align: base |
|                                      | line !important; width: auto !import |
|                                      | ant;"}                               |
|                                      | `(`{.c .plain                        |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`int`{.c                 |
|                                      | .color1 .bold                        |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; color: gray !important; float |
|                                      | : none !important; font-family: Cons |
|                                      | olas, 'Bitstream Vera Sans Mono', 'C |
|                                      | ourier New', Courier, monospace !imp |
|                                      | ortant; font-weight: bold !important |
|                                      | ; height: auto !important; left: aut |
|                                      | o !important; line-height: 1.1em !im |
|                                      | portant; margin: 0px !important; min |
|                                      | -height: inherit !important; outline |
|                                      | : 0px !important; overflow: visible  |
|                                      | !important; padding: 0px !important; |
|                                      |  position: static !important; right: |
|                                      |  auto !important; top: auto !importa |
|                                      | nt; vertical-align: baseline !import |
|                                      | ant; width: auto !important;"}       |
|                                      | `i = 0; i < 1000000; i++) {`{.c      |
|                                      | .plain                               |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}                         |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number7 index6 alt2"     |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      | `                   `{.c .spaces     |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`int`{.c                 |
|                                      | .color1 .bold                        |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; color: gray !important; float |
|                                      | : none !important; font-family: Cons |
|                                      | olas, 'Bitstream Vera Sans Mono', 'C |
|                                      | ourier New', Courier, monospace !imp |
|                                      | ortant; font-weight: bold !important |
|                                      | ; height: auto !important; left: aut |
|                                      | o !important; line-height: 1.1em !im |
|                                      | portant; margin: 0px !important; min |
|                                      | -height: inherit !important; outline |
|                                      | : 0px !important; overflow: visible  |
|                                      | !important; padding: 0px !important; |
|                                      |  position: static !important; right: |
|                                      |  auto !important; top: auto !importa |
|                                      | nt; vertical-align: baseline !import |
|                                      | ant; width: auto !important;"}       |
|                                      | `dis = StringUtils .getLevenshteinDi |
|                                      | stance(s1, s2);`{.c                  |
|                                      | .plain                               |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}                         |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number8 index7 alt1"     |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      | `            `{.c .spaces            |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`}`{.c                   |
|                                      | .plain                               |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}                         |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number9 index8 alt2"     |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      |                                      |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number10 index9 alt1"    |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      | `            `{.c .spaces            |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`long`{.c                |
|                                      | .color1 .bold                        |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; color: gray !important; float |
|                                      | : none !important; font-family: Cons |
|                                      | olas, 'Bitstream Vera Sans Mono', 'C |
|                                      | ourier New', Courier, monospace !imp |
|                                      | ortant; font-weight: bold !important |
|                                      | ; height: auto !important; left: aut |
|                                      | o !important; line-height: 1.1em !im |
|                                      | portant; margin: 0px !important; min |
|                                      | -height: inherit !important; outline |
|                                      | : 0px !important; overflow: visible  |
|                                      | !important; padding: 0px !important; |
|                                      |  position: static !important; right: |
|                                      |  auto !important; top: auto !importa |
|                                      | nt; vertical-align: baseline !import |
|                                      | ant; width: auto !important;"}       |
|                                      | `t2 = System.currentTimeMillis();`{. |
|                                      | c                                    |
|                                      | .plain                               |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}                         |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number11 index10 alt2"   |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      |                                      |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | <div                                 |
|                                      | class="line number12 index11 alt1"   |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; heigh |
|                                      | t: auto !important; left: auto !impo |
|                                      | rtant; line-height: 1.1em !important |
|                                      | ; margin: 0px !important; min-height |
|                                      | : inherit !important; outline: 0px ! |
|                                      | important; overflow: visible !import |
|                                      | ant; padding: 0px 1em !important; po |
|                                      | sition: static !important; right: au |
|                                      | to !important; top: auto !important; |
|                                      |  vertical-align: baseline !important |
|                                      | ; white-space: pre !important; width |
|                                      | : auto !important;">                 |
|                                      |                                      |
|                                      | `            `{.c .spaces            |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`System. out .println(`{ |
|                                      | .c                                   |
|                                      | .plain                               |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`" 耗费时间： "`{.c      |
|                                      | .string                              |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; color: blue !important; float |
|                                      | : none !important; font-family: Cons |
|                                      | olas, 'Bitstream Vera Sans Mono', 'C |
|                                      | ourier New', Courier, monospace !imp |
|                                      | ortant; height: auto !important; lef |
|                                      | t: auto !important; line-height: 1.1 |
|                                      | em !important; margin: 0px !importan |
|                                      | t; min-height: inherit !important; o |
|                                      | utline: 0px !important; overflow: vi |
|                                      | sible !important; padding: 0px !impo |
|                                      | rtant; position: static !important;  |
|                                      | right: auto !important; top: auto !i |
|                                      | mportant; vertical-align: baseline ! |
|                                      | important; width: auto !important;"} |
|                                      | `+ (t2 - t1) + `{.c .plain           |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}`"  ms "`{.c             |
|                                      | .string                              |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; color: blue !important; float |
|                                      | : none !important; font-family: Cons |
|                                      | olas, 'Bitstream Vera Sans Mono', 'C |
|                                      | ourier New', Courier, monospace !imp |
|                                      | ortant; height: auto !important; lef |
|                                      | t: auto !important; line-height: 1.1 |
|                                      | em !important; margin: 0px !importan |
|                                      | t; min-height: inherit !important; o |
|                                      | utline: 0px !important; overflow: vi |
|                                      | sible !important; padding: 0px !impo |
|                                      | rtant; position: static !important;  |
|                                      | right: auto !important; top: auto !i |
|                                      | mportant; vertical-align: baseline ! |
|                                      | important; width: auto !important;"} |
|                                      | `);`{.c                              |
|                                      | .plain                               |
|                                      | style="background-image: none !impor |
|                                      | tant; border-bottom-left-radius: 0px |
|                                      |  !important; border-bottom-right-rad |
|                                      | ius: 0px !important; border-top-left |
|                                      | -radius: 0px !important; border-top- |
|                                      | right-radius: 0px !important; border |
|                                      | : 0px !important; bottom: auto !impo |
|                                      | rtant; box-sizing: content-box !impo |
|                                      | rtant; float: none !important; font- |
|                                      | family: Consolas, 'Bitstream Vera Sa |
|                                      | ns Mono', 'Courier New', Courier, mo |
|                                      | nospace !important; height: auto !im |
|                                      | portant; left: auto !important; line |
|                                      | -height: 1.1em !important; margin: 0 |
|                                      | px !important; min-height: inherit ! |
|                                      | important; outline: 0px !important;  |
|                                      | overflow: visible !important; paddin |
|                                      | g: 0px !important; position: static  |
|                                      | !important; right: auto !important;  |
|                                      | top: auto !important; vertical-align |
|                                      | : baseline !important; width: auto ! |
|                                      | important;"}                         |
|                                      |                                      |
|                                      | </div>                               |
|                                      |                                      |
|                                      | </div>                               |
+--------------------------------------+--------------------------------------+

</div>

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

耗费时间： 4266 ms

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

大跌眼镜，居然计算耗费4秒。假设我们一天需要比较100w次，光是比较100w次的数据是否重复就需要4s，就算4s一个文档，单线程一分钟才处理15个文档，一个小时才900个，一天也才21600个文档，这个数字和一天100w相差甚远，需要多少机器和资源才能解决。

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

为此我们需要一种应对于海量数据场景的去重方案，经过研究发现有种叫 local
sensitive hash 局部敏感哈希
的东西，据说这玩意可以把文档降维到hash数字，数字两两计算运算量要小很多。查找很多文档后看到google对于网页去重使用的是simhash，他们每天需要处理的文档在亿级别，大大超过了我们现在文档的水平。既然老大哥也有类似的应用，我们也赶紧尝试下。simhash是由
Charikar 在2002年提出来的，参考 [《Similarity estimation techniques from
rounding
algorithms》](http://dl.acm.org/citation.cfm?id=509965 "Similarity estimation techniques from rounding algorithms") 。
介绍下这个算法主要原理，为了便于理解尽量不使用数学公式，分为这几步：

</div>

-   **1、分词**，把需要判断文本分词形成这个文章的特征单词。最后形成去掉噪音词的单词序列并为每个词加上权重，我们假设权重分为5个级别（1
~5）。比如：“
    美国“51区”雇员称内部有9架飞碟，曾看见灰色外星人 ” ==&gt; 分词后为 “
    美国（4） 51区（5） 雇员（3） 称（1） 内部（2） 有（1） 9架（3）
    飞碟（5） 曾（1） 看见（3） 灰色（4）
    外星人（5）”，括号里是代表单词在整个句子里重要程度，数字越大越重要。
-   **2、hash**，通过hash算法把每个词变成hash值，比如“美国”通过hash算法计算为
    100101,“51区”通过hash算法计算为
    101011。这样我们的字符串就变成了一串串数字，还记得文章开头说过的吗，要把文章变为数字计算才能提高相似度计算性能，现在是降维过程进行时。
-   **3、加权**，通过
    2步骤的hash生成结果，需要按照单词的权重形成加权数字串，比如“美国”的hash值为“100101”，通过加权计算为“4
    -4 -4 4 -4 4”；“51区”的hash值为“101011”，通过加权计算为 “ 5 -5 5 -5
    5 5”。
-   **4、合并**，把上面各个单词算出来的序列值累加，变成只有一个序列串。比如
    “美国”的 “4 -4 -4 4 -4 4”，“51区”的 “ 5 -5 5 -5 5 5”，
    把每一位进行累加， “4+5 -4+-5 -4+5 4+-5 -4+5 4+5” ==》 “9 -9 1 -1 1
    9”。这里作为示例只算了两个单词的，真实计算需要把所有单词的序列串累加。
-   **5、降维**，把4步算出来的 “9 -9 1 -1 1 9” 变成 0 1
    串，形成我们最终的simhash签名。 如果每一位大于0 记为 1，小于0 记为
    0。最后算出结果为：“1 0 1 0 1 1”。

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

整个过程图为：

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

[![simhash](http://cdn2.jobbole.com/2013/08/simhash.png){.aligncenter
.size-full
.wp-image-46840}](http://cdn2.jobbole.com/2013/08/simhash.png "海量数据相似度计算之simhash和海明距离"){.cboxElement}

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

大家可能会有疑问，经过这么多步骤搞这么麻烦，不就是为了得到个 0 1
字符串吗？我直接把这个文本作为字符串输入，用hash函数生成 0 1
值更简单。其实不是这样的，传统hash函数解决的是生成唯一值，比如
md5、hashmap等。md5是用于生成唯一签名串，只要稍微多加一个字符md5的两个数字看起来相差甚远；hashmap也是用于键值对查找，便于快速插入和查找的数据结构。不过我们主要解决的是文本相似度计算，要比较的是两个文章是否相识，当然我们降维生成了hashcode也是用于这个目的。看到这里估计大家就明白了，我们使用的simhash就算把文章中的字符串变成
01
串也还是可以用于计算相似度的，而传统的hashcode却不行。我们可以来做个测试，两个相差只有一个字符的文本串，“你妈妈喊你回家吃饭哦，回家罗回家罗”
和 “你妈妈叫你回家吃饭啦，回家罗回家罗”。

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

通过simhash计算结果为：

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

1000010010101101**1**11111100000101011010001001111100001**0**0101**1**001011

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

1000010010101101**0**11111100000101011010001001111100001**1**0101**0**001011

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

通过 hashcode计算为：

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

1111111111111111111111111111111110001000001100110100111011011110

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

1010010001111111110010110011101

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

大家可以看得出来，相似的文本只有部分 01
串变化了，而普通的hashcode却不能做到，这个就是局部敏感哈希的魅力。目前Broder提出的shingling算法和Charikar的simhash算法应该算是业界公认比较好的算法。在simhash的发明人Charikar的论文中并没有给出具体的simhash算法和证明，[“量子图灵”得出的证明simhash是由随机超平面hash算法演变而来的](http://www.cnblogs.com/linecong/archive/2010/08/28/simhash.html "simhash是由随机超平面hash算法演变而来的")。

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

现在通过这样的转换，我们把库里的文本都转换为simhash
代码，并转换为long类型存储，空间大大减少。现在我们虽然解决了空间，但是如何计算两个simhash的相似度呢？难道是比较两个simhash的01有多少个不同吗？对的，其实也就是这样，我们通过海明距离（Hamming
distance）就可以计算出两个simhash到底相似不相似。两个simhash对应二进制（01串）取值不同的数量称为这两个simhash的海明距离。举例如下： **1**01**01** 和 **0**01**10** 从第一位开始依次有第一位、第四、第五位不同，则海明距离为3。对于二进制字符串的a和b，海明距离为等于在a
XOR b运算结果中1的个数（普遍算法）。

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

为了高效比较，我们预先加载了库里存在文本并转换为simhash code
存储在内存空间。来一条文本先转换为 simhash code，然后和内存里的simhash
code 进行比较，测试100w次计算在100ms。速度大大提升。

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

未完待续：

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

1、目前速度提升了但是数据是不断增量的，如果未来数据发展到一个小时100w，按现在一次100ms，一个线程处理一秒钟
10次，一分钟 60 
* 10 次，一个小时 60
*10 
*60 次 = 36000次，一天
60
*10
*60
*24 = 864000次。
我们目标是一天100w次，通过增加两个线程就可以完成。但是如果要一个小时100w次呢？则需要增加30个线程和相应的硬件资源保证速度能够达到，这样成本也上去了。能否有更好的办法，提高我们比较的效率？

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

2、通过大量测试，simhash用于比较大文本，比如500字以上效果都还蛮好，距离小于3的基本都是相似，误判率也比较低。但是如果我们处理的是微博信息，最多也就140个字，使用simhash的效果并不那么理想。看如下图，在距离为3时是一个比较折中的点，在距离为10时效果已经很差了，不过我们测试短文本很多看起来相似的距离确实为10。如果使用距离为3，短文本大量重复信息不会被过滤，如果使用距离为10，长文本的错误率也非常高，如何解决？

</div>

<div
style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin-bottom: 20px; padding: 0px;">

[![simhash2](http://cdn2.jobbole.com/2013/08/simhash2.png){.aligncenter
.size-full
.wp-image-46841}](http://cdn2.jobbole.com/2013/08/simhash2.png "海量数据相似度计算之simhash和海明距离"){.cboxElement}

</div>

</div>

---
layout: post
title: 37条常用Linux Shell命令组合
date: '2013-09-17T13:16:00.001+08:00'
author: Wenh Q
tags: 
modified_time: '2013-09-17T13:16:11.503+08:00'
blogger_id: tag:blogger.com,1999:blog-4961947611491238191.post-1914212515102224490
blogger_orig_url: http://binaryware.blogspot.com/2013/09/37linux-shell.html
---

<div style="margin: 10px; padding: 5px;"><div style="font-size: 18px;"><a href="http://blog.jobbole.com/48173/">37条常用Linux Shell命令组合</a>     </div><div style="font-size: 13px;">Via <a href="http://blog.jobbole.com/">博客 - 伯乐在线</a>     </div></div><div style="font-size: 13px; padding: 15px 0 10px 10px;">童燕群总结分享的 37 条常用 Linux Shell 命令<br /><a href="http://blog.jobbole.com/48173/">37条常用Linux Shell命令组合</a>，首发于<a href="http://blog.jobbole.com/">博客 - 伯乐在线</a>。<br /><br /><br /><table border="0" cellpadding="0" cellspacing="0" style="background-color: white; border-collapse: collapse; border-spacing: 0px; border: 1px solid rgb(232, 232, 232); color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin: 0px 0px 20px; padding: 0px 5px; width: 770px;"><tbody style="border: 0px; margin: 0px; padding: 0px;"><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;" width="40">序号</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;" width="278"><strong style="border: 0px; margin: 0px; padding: 0px;">任务</strong></td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;" width="456"><strong style="border: 0px; margin: 0px; padding: 0px;">命令组合</strong></td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">1</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">删除0字节文件</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">find . -type f -size 0 -exec rm -rf {} \;<br />find . type f -size 0 -delete</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">2</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">查看进程，按内存从大到小排列</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ps -e -o “%C : %p : %z : %a”|sort -k5 -nr</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">3</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">按cpu利用率从大到小排列</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ps -e -o “%C : %p : %z : %a”|sort -nr</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">4</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">打印说cache里的URL</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">grep -r -a jpg /data/cache/* | strings | grep “http:” | awk -F’http:’ ‘{print “http:”$2;}’</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">5</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">查看http的并发请求数及其TCP连接状态</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">netstat -n | awk ‘/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}’</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">6</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">sed在这个文里Root的一行，匹配Root一行，将no替换成yes。</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">sed -i ‘/Root/s/no/yes/’ /etc/ssh/sshd_config</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="86.67" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">7</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">如何杀掉mysql进程</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ps aux |grep mysql |grep -v grep&nbsp;&nbsp;|awk ‘{print $2}’ |xargs kill -9<br />killall -TERM mysqld<br />kill -9 `cat /usr/local/apache2/logs/httpd.pid`</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">8</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">显示运行3级别开启的服务(从中了解到cut的用途，截取数据)</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ls /etc/rc3.d/S* |cut -c 15-</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="132" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">9</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">如何在编写SHELL显示多个信息，用EOF</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">cat &lt;&lt; EOF<br />+————————————————————–+<br />|&nbsp;&nbsp;&nbsp;=== Welcome to Tunoff services ===&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />+————————————————————–+<br />EOF</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="114.67" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">10</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">for的用法(如给mysql建软链接)</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">cd /usr/local/mysql/bin<br />for i in *<br />do ln /usr/local/mysql/bin/$i /usr/bin/$i<br />done</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="88" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">11</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">取IP地址</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ifconfig eth0 |grep “inet addr:” |awk ‘{print $2}’|cut -c 6-<br />ifconfig | grep ‘inet addr:’| grep -v ’127.0.0.1′ |cut -d: -f2 | awk ‘{ print $1}’</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">12</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">内存的大小</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">free -m |grep “Mem” | awk ‘{print $2}’</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="68" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">13</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">查看80端口的连接，并排序</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">netstat -an -t | grep “:80″ | grep ESTABLISHED | awk ‘{printf “%s %s\n”,$5,$6}’ | sort</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="72" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">14</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">查看Apache的并发请求数及其TCP连接状态</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">netstat -n | awk ‘/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}’</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">15</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">统计一下服务器下面所有的jpg的文件的大小</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">find / -name *.jpg -exec wc -c {} \;|awk ‘{print $1}’|awk ‘{a+=$1}END{print a}’</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">16</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">CPU的数量</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">cat /proc/cpuinfo |grep -c processor</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">17</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">CPU负载</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">cat /proc/loadavg</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">18</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">CPU负载</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">mpstat 1 1</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">19</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">内存空间</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">free</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">20</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">磁盘空间</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">df -h</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">21</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">如发现某个分区空间接近用尽，可以进入该分区的挂载点，用以下命令找出占用空间最多的文件或目录</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">du -cks * | sort -rn | head -n 10</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">22</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">磁盘I/O负载</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">iostat -x 1 2</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">23</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">网络负载</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">sar -n DEV</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">24</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">网络错误</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">netstat -i<br />cat /proc/net/dev</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">25</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">网络连接数目</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">netstat -an | grep -E “^(tcp)” | cut -c 68- | sort | uniq -c | sort -n</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">26</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">进程总数</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ps aux | wc -l</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">27</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">查看进程树</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">ps aufx</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">28</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">可运行进程数目</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">vmwtat 1 5</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">29</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">检查DNS Server工作是否正常，这里以61.139.2.69为例</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">dig www.baidu.com @61.139.2.69</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">30</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">检查当前登录的用户个数</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">who | wc -l</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="112" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">31</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">日志查看、搜索</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">cat /var/log/rflogview/*errors<br />grep -i error /var/log/messages<br />grep -i fail /var/log/messages<br />tail -f -n 2000 /var/log/messages</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">32</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">内核日志</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">dmesg</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">33</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">时间</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">date</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">34</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">已经打开的句柄数</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">lsof | wc -l</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">35</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">网络抓包，直接输出摘要信息到文件。</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">tcpdump -c 10000 -i eth0 -n dst port 80 &gt; /root/pkts</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="96" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">36</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">然后检查IP的重复数 并从小到大排序 注意 “-t\&nbsp;&nbsp;+0″ 中间是两个空格，less命令的用法。</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">less pkts | awk {‘printf $3″\n”‘} | cut -d. -f 1-4 | sort | uniq -c | awk {‘printf $1″ “$2″\n”‘} | sort -n -t\&nbsp;&nbsp;+0</td></tr><tr style="border-bottom-color: rgb(232, 232, 232); border-bottom-style: solid; border-width: 0px 0px 1px; margin: 0px; padding: 0px;"><td height="56" style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">37</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">kudzu查看网卡型号</td><td style="border: 0px; margin: 0px; padding: 5px; text-align: center; vertical-align: middle;">kudzu –probe –class=network</td></tr></tbody></table><div class="post-ratings" data-nonce="ca5dae737d" id="post-ratings-48173" itemscope="" itemtype="http://schema.org/Product" style="background-color: white; border: 0px; color: #333333; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; margin: 0px; opacity: 1; padding: 0px; width: 620px;"><br /></div></div>
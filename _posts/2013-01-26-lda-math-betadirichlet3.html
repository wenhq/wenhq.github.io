---
layout: post
title: LDA-math-认识Beta/Dirichlet分布(3)
date: '2013-01-26T12:16:00.001+08:00'
author: Wenh Q
tags:
- NLP
- tech.nlp
modified_time: '2013-11-30T12:25:43.989+08:00'
blogger_id: tag:blogger.com,1999:blog-4961947611491238191.post-2528886975400260080
blogger_orig_url: http://binaryware.blogspot.com/2013/01/lda-math-betadirichlet3.html
---

<a href="http://feedproxy.google.com/~r/52nlp/~3/QmrqEcQikDc/lda-math-%e8%ae%a4%e8%af%86betadirichlet%e5%88%86%e5%b8%833">LDA-math-认识Beta/Dirichlet分布(3)</a>: <br /><b>2. LDA-math-认识Beta/Dirichlet分布(3)</b><br /><br /><b> 2.3 Dirichlet-Multinomial 共轭</b><br />对于魔鬼变本加厉的新的游戏规则，数学形式化如下：<br /><ol><li>$X_1,X_2,\cdots,X_n {\stackrel{\mathrm{iid}} {\sim}}Uniform(0,1)$，</li><li>排序后对应的顺序统计量 $X_{(1)},X_{(2)}，\cdots, X_{(n)}$,</li><li>问 $(X_{(k_1)}, X_{(k_1+k_2)})$的联合分布是什么；</li></ol><div style="text-align: center;"><b>游戏3</b></div>完全类似于第一个游戏的推导过程，我们可以进行如下的概率计算(为了数学公式的简洁对称，我们取$x_3$满足$x_1+x_2+x_3 = 1$,但只有$x_1,x_2$是变量)<br /><br /><br /><div style="text-align: center;"><a href="http://www.52nlp.cn/5165/dirichlet-game" rel="attachment wp-att-5166"><img alt="dirichlet-game" height="171" src="http://www.52nlp.cn/wp-content/uploads/2013/01/dirichlet-game.png" width="917" /></a> <a href="http://www.52nlp.cn/5165/dirichlet-distribution" rel="attachment wp-att-5167"><br /><br /></a>$(X_{(k_1)}, X_{(k_1+k_2)})$<b>的联合分布推导</b></div>\begin{align*}<br /><br />&amp; P\Bigl(X_{(k_1)}\in(x_1,x_1+\Delta x),X_{(k_1+k_2)}\in(x_2,x_2+\Delta x)\Bigr) \\<br /><br />&amp; = n(n-1)\binom{n-2}{k_1-1,k_2-1}x_1^{k_1-1}x_2^{k_2-1}x_3^{n-k_1-k_2}(\Delta x)^2 \\<br /><br />&amp; = \frac{n!}{(k_1-1)!(k_2-1)!(n-k_1-k_2)!}x_1^{k_1-1}x_2^{k_2-1}x_3^{n-k_1-k_2}(\Delta x)^2<br /><br />\end{align*}<br /><br />于是我们得到 $(X_{(k_1)}, X_{(k_1+k_2)})$的联合分布是<br /><br />\begin{align*}<br /><br />f(x_1,x_2,x_3) &amp; = \frac{n!}{(k_1-1)!(k_2-1)!(n-k_1-k_2)!}x_1^{k_1-1}x_2^{k_2-1}x_3^{n-k_1-k_2} \\<br /><br />&amp; = \frac{\Gamma(n+1)}{\Gamma(k_1)\Gamma(k_2)\Gamma(n-k_1-k_2+1)}x_1^{k_1-1}x_2^{k_2-1}x_3^{n-k_1-k_2}<br /><br />\end{align*}<br /><br />熟悉 Dirichlet的同学一眼就可以看出，上面这个分布其实就是3维形式的 Dirichlet 分布$Dir(x_1,x_2,x_3|k_1,k_2,n-k_1-k_2+1)$。令 $\alpha_1=k_1,\alpha_2=k_2,\alpha_3=n-k_1-k_2+1$,于是分布密度可以写为<br /><br />\begin{equation}<br /><br />\displaystyle f(x_1,x_2,x_3) = \frac{\Gamma(\alpha_1 + \alpha_2 + \alpha_3)}<br /><br />{\Gamma(\alpha_1)\Gamma(\alpha_2)\Gamma(\alpha_3)}x_1^{\alpha_1-1}x_2^{\alpha_2-1}x_3^{\alpha_3-1}<br /><br />\end{equation}<br />这个就是一般形式的3维 Dirichlet 分布，即便 $\overrightarrow{\alpha}=(\alpha_1,\alpha_2, \alpha_3)$ 延拓到非负实数集合，以上概率分布也是良定义的。<br /><div style="text-align: left;">从形式上我们也能看出，Dirichlet 分布是Beta 分布在高维度上的推广，他和Beta 分布一样也是一个百变星君，密度函数可以展现出多种形态。</div><div style="text-align: center;"><a href="http://www.52nlp.cn/5165/dirichlet-distribution" rel="attachment wp-att-5167"><img alt="dirichlet-distribution" height="303" src="http://www.52nlp.cn/wp-content/uploads/2013/01/dirichlet-distribution.png" width="670" /></a><b>不同 $\alpha$ 下的Dirichlet 分布</b></div>类似于魔鬼的游戏2，我们也可以调整一下游戏3，从魔盒中生成$m$个随机数$Y_1,Y_2,\cdots,Y_m {\stackrel{\mathrm{iid}}{\sim}}Uniform(0,1)$ 并让魔鬼告诉我们$Y_i$和$(X_{(k_1)}, X_{(k_1+k_2)})$相比谁大谁小。于是有如下游戏4<br /><ol><li>&nbsp;$X_1,X_2,\cdots,X_n {\stackrel{\mathrm{iid}}{\sim}}Uniform(0,1)$，排序后对应的顺序统计量 $X_{(1)},X_{(2)}，\cdots, X_{(n)}$</li><li>令$p_1=X_{(k_1)}, p_2=X_{(k_1+k_2)},p_3 = 1-p_1-p_2$(加上$p_3$是为了数学表达简洁对称),我们要猜测 $\overrightarrow{p}=(p_1,p_2,p_3)$；</li><li>$Y_1,Y_2,\cdots,Y_m {\stackrel{\mathrm{iid}}{\sim}}Uniform(0,1)$, $Y_i$中落到$[0,p_1),[p_1,p_2),[p_2,1]$ 三个区间的个数分别为 $m_1,m_2,m_3$，$m=m_1+m_2+m3$；</li><li>&nbsp;问后验分布 $P(\overrightarrow{p}|Y_1,Y_2,\cdots,Y_m)$ 的分布是什么。</li></ol><div style="text-align: center;"><b>游戏4</b></div>为了方便，我们记<br /><br />$ \overrightarrow{m}=(m_1,m_2,m_3),\quad \overrightarrow{k}=(k_1,k_2,n-k_1-k_2+1) $<br /><br />由游戏中的信息，我们可以推理得到 $p_1, p_2$在$X_1,X_2,\cdots,X_n,$ $Y_1,Y_2,\cdots,Y_m$ ${\stackrel{\mathrm{iid}}{\sim}} Uniform(0,1)$这 $m+n$个数中分别成为了第 $k_1+m_1, k_2+m_2$大的数，于是后验分布 $P(\overrightarrow{p}|Y_1,Y_2,\cdots,Y_m)$ 应该是 $Dir(\overrightarrow{p}|k_1+m_1,k_1+m_2,n-k_1-k_2+1+m_3)$,即$Dir(\overrightarrow{p}|\overrightarrow{k}+\overrightarrow{m})$。按照贝叶斯推理的逻辑，我们同样可以把以上过程整理如下：<br /><ol><li>&nbsp;我们要猜测参数 $\overrightarrow{p}=(p_1,p_2,p_3)$，其先验分布为$Dir(\overrightarrow{p}|\overrightarrow{k})$；</li><li>&nbsp;数据$Y_i$落到$[0,p_1), [p_1,p_2),[p_2,1]$三个区间的个数分别为 $m_1,m_2,m_3$，所以$\overrightarrow{m}=(m_1,m_2,m_3)$ 服从多项分布$Mult(\overrightarrow{m}|\overrightarrow{p})$</li><li>&nbsp;在给定了来自数据提供的知识$\overrightarrow{m}$后，$\overrightarrow{p}$ 的后验分布变为 $Dir(\overrightarrow{p}|\overrightarrow{k}+\overrightarrow{m})$</li></ol><div style="text-align: center;"><b>贝叶斯推理过程</b></div>以上贝叶斯分析过程的简单直观的表述就是<br /><br />$ Dir(\overrightarrow{p}|\overrightarrow{k}) + MultCount(\overrightarrow{m}) = Dir(\overrightarrow{p}|\overrightarrow{k}+\overrightarrow{m}) $<br /><br />令 $\overrightarrow{\alpha}=\overrightarrow{k}$,把$\overrightarrow{\alpha}$从整数集合延拓到实数集合，更一般的可以证明有如下关系<br /><br />\begin{equation}<br /><br />Dir(\overrightarrow{p}|\overrightarrow{\alpha}) + MultCount(\overrightarrow{m})<br /><br />= Dir(p|\overrightarrow{\alpha}+\overrightarrow{m})<br /><br />\end{equation}<br /><br />以上式子实际上描述的就是 <b>Dirichlet-Multinomial 共轭</b>，而我们从以上过程可以看到，Dirichlet 分布中的参数$\overrightarrow{\alpha}$都可以理解为物理计数。类似于 Beta 分布，我们也可以把 $Dir(\overrightarrow{p}|\overrightarrow{\alpha})$作如下分解<br /><br />$ Dir(\overrightarrow{p}|\overrightarrow{1}) + MultCount(\overrightarrow{m}-\overrightarrow{1})<br /><br />= Dir(\overrightarrow{p}|\overrightarrow{\alpha}) $<br /><br />此处$\overrightarrow{1}=(1,1,\cdots,1)$。自然，上式我们也可以类似地用纯粹贝叶斯的观点进行推导和解释。<br />以上的游戏我们还可以往更高的维度上继续推，譬如猜测 $X_{(1)},X_{(2)}，\cdots, X_{(n)}$ 中的4、5、…等更多个数，于是就得到更高纬度的 Dirichlet 分布和 Dirichlet-Multinomial 共轭。一般形式的 Dirichlet 分布定义如下<br /><br />\begin{equation}<br /><br />\displaystyle Dir(\overrightarrow{p}|\overrightarrow{\alpha}) =<br /><br />\displaystyle \frac{\Gamma(\sum_{k=1}^K\alpha_k)}<br /><br />{\prod_{k=1}^K\Gamma(\alpha_k)} \prod_{k=1}^K p_k^{\alpha_k-1}<br /><br />\end{equation}<br /><br />对于给定的 $\overrightarrow{p}$和 $N$,多项分布定义为<br /><br />\begin{equation}<br /><br />\displaystyle Mult(\overrightarrow{n} |\overrightarrow{p},N) = \binom{N}{\overrightarrow{n}}\prod_{k=1}^K p_k^{n_k}<br /><br />\end{equation}<br /><br />而 $Mult(\overrightarrow{n} |\overrightarrow{p},N)$ 和 $Dir(\overrightarrow{p}|\overrightarrow{\alpha})$这两个分布是共轭关系。<br />Beta-Binomail 共轭和 Dirichlet-Multinomail 共轭都可以用纯粹数学的方式进行证明，我们在这两个小节中通过一个游戏来解释这两个共轭关系，主要是想说明这个共轭关系是可以对应到很具体的概率物理过程的。<br /><b>2.4 Beta/Dirichlet 分布的一个性质</b><br />如果 $p\sim Beta(t|\alpha,\beta)$, 则<br /><br />\begin{align*}<br /><br />E(p) &amp; = \int_0^1 t*Beta(t|\alpha,\beta)dt \\<br /><br />&amp; = \int_0^1 t* \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)} t^{\alpha-1}(1-t)^{\beta-1}dt \\<br /><br />&amp; = \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)} \int_0^1 t^{\alpha}(1-t)^{\beta-1}dt<br /><br />\end{align*}<br /><br />上式右边的积分对应到概率分布 $Beta(t|\alpha+1,\beta)$，对于这个分布，我们有<br /><br />$<br /><br />\int_0^1 \frac{\Gamma(\alpha+\beta+1)}{\Gamma(\alpha+1)\Gamma(\beta)} t^{\alpha}(1-t)^{\beta-1}dt = 1<br /><br />$<br /><br />把上式带入$E(p)$的计算式，得到<br /><br />\begin{align}<br /><br />E(p) &amp; = \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}<br /><br />\cdot \frac{\Gamma(\alpha+1)\Gamma(\beta)}{\Gamma(\alpha+\beta+1)} \notag \\<br /><br />&amp; = \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha+\beta+1)}\frac{\Gamma(\alpha+1)}{\Gamma(\alpha)} \notag \\<br /><br />&amp; = \frac{\alpha}{\alpha+\beta}<br /><br />\label{beta-mean}<br /><br />\end{align}<br /><br />这说明，对于Beta 分布的随机变量，其均值可以用$\frac{\alpha}{\alpha+\beta}$来估计。Dirichlet 分布也有类似的结论，如果$\overrightarrow{p} \sim Dir(\overrightarrow{t}|\overrightarrow{\alpha})$，同样可以证明<br /><br />\begin{equation}<br /><br />E(\overrightarrow{p}) = \Bigl(\frac{\alpha_1}{\sum_{i=1}^K\alpha_i},\frac{\alpha_2}{\sum_{i=1}^K\alpha_i},\cdots, \frac{\alpha_K}{\sum_{i=1}^K\alpha_i} \Bigr)<br /><br />\label{dir-mean}<br /><br />\end{equation}<br /><br />以上两个结论很重要，因为我们在后面的 LDA 数学推导中需要使用这个结论。<br /><div>相关文章:<br /><ol><li><a href="http://www.52nlp.cn/lda-math-%e8%ae%a4%e8%af%86betadirichlet%e5%88%86%e5%b8%831" rel="bookmark" title="LDA-math-认识Beta/Dirichlet分布(1)">LDA-math-认识Beta/Dirichlet分布(1)</a></li><li><a href="http://www.52nlp.cn/lda-math-%e8%ae%a4%e8%af%86betadirichlet%e5%88%86%e5%b8%832" rel="bookmark" title="LDA-math-认识Beta/Dirichlet分布(2)">LDA-math-认识Beta/Dirichlet分布(2)</a></li><li><a href="http://www.52nlp.cn/lda-math-%e7%a5%9e%e5%a5%87%e7%9a%84gamma%e5%87%bd%e6%95%b03" rel="bookmark" title="LDA-math-神奇的Gamma函数(3)">LDA-math-神奇的Gamma函数(3)</a></li><li><a href="http://www.52nlp.cn/lda-math-%e7%a5%9e%e5%a5%87%e7%9a%84gamma%e5%87%bd%e6%95%b01" rel="bookmark" title="LDA-math-神奇的Gamma函数(1)">LDA-math-神奇的Gamma函数(1)</a></li><li><a href="http://www.52nlp.cn/lda-math-%e7%a5%9e%e5%a5%87%e7%9a%84gamma%e5%87%bd%e6%95%b02" rel="bookmark" title="LDA-math-神奇的Gamma函数(2)">LDA-math-神奇的Gamma函数(2)</a></li><li><a href="http://www.52nlp.cn/lda-math-mcmc-%e5%92%8c-gibbs-sampling2" rel="bookmark" title="LDA-math-MCMC 和 Gibbs Sampling(2)">LDA-math-MCMC 和 Gibbs Sampling(2)</a></li><li><a href="http://www.52nlp.cn/lda-math-mcmc-%e5%92%8c-gibbs-sampling1" rel="bookmark" title="LDA-math-MCMC 和 Gibbs Sampling(1)">LDA-math-MCMC 和 Gibbs Sampling(1)</a></li><li><a href="http://www.52nlp.cn/%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e7%9a%84%e5%89%8d%e4%b8%96%e4%bb%8a%e7%94%9f%e5%9b%9b" rel="bookmark" title="正态分布的前世今生(四)">正态分布的前世今生(四)</a></li><li><a href="http://www.52nlp.cn/%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e7%9a%84%e5%89%8d%e4%b8%96%e4%bb%8a%e7%94%9f%e4%ba%8c" rel="bookmark" title="正态分布的前世今生(二)">正态分布的前世今生(二)</a></li><li><a href="http://www.52nlp.cn/hmm-learn-best-practices-seven-forward-backward-algorithm-5" rel="bookmark" title="HMM学习最佳范例七：前向-后向算法5">HMM学习最佳范例七：前向-后向算法5</a></li></ol></div><img height="1" src="http://feeds.feedburner.com/~r/52nlp/~4/QmrqEcQikDc" width="1" />
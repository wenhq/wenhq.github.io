---
layout: post
title: "编程随想 | 如何隐藏你的踪迹，避免跨省追捕[6]：用虚拟机隐匿公网IP"
date: '2013-07-30T11:09:00.004+08:00'
author: Wenh Q
tags:
modified_time: '2013-07-30T11:09:48.187+08:00'
thumbnail: https://lh5.googleusercontent.com/RrU5gH1m28mihu1Tn07uq1S_ewEGkwUG6hMc4dxIZ1ty_ripBY_YD8czrHjhFm1wvLuvhKSdKsKReRfnyuplf6VNLCjDWT2kYEAeuJP2kqp1NQW-5OTLv5BP=s72-c
blogger_id: tag:blogger.com,1999:blog-4961947611491238191.post-3900167682896661489
blogger_orig_url: http://binaryware.blogspot.com/2013/07/6ip.html
---

[
编程随想 |
如何隐藏你的踪迹，避免跨省追捕[6]：用虚拟机隐匿公网IP](http://feedproxy.google.com/~r/chinagfwblog/~3/maKr8cnJiDo/)

于 13-1-3 通过 ["GFW Blog(功夫网与翻墙)" via 数字时代 in Google
Reader](http://feeds2.feedburner.com/chinagfwblog) 作者：Chinese
Netizens

在多位读者的强烈要求下，本文终于隆重推出了 :)
今天俺来介绍一下：如何利用操作系统虚拟机（以下简称”虚拟机”）来隐匿自己的公网IP。

★准备工作 {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
---------

为了给本文打基础，俺在最近两个月特地写了一个《扫盲操作系统虚拟机》的系列博文（链接在”[这里](http://program-think.blogspot.com/2012/10/system-vm-0.html)“）。如果你不是
IT
技术人员，或者你对虚拟机了解不多，强烈建议你先把这个虚拟机扫盲系列看完，然后再来看本文。

在本系列第一篇《[网络方面的防范](http://program-think.blogspot.com/2010/04/howto-cover-your-tracks-1.html)》，俺专门解释了：”什么是公网IP”，也特别强调了公网IP暴露的危险性。如果你比较健忘的话，先去把那篇再复习一下。

★无代理的情形 {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
-------------

如果你上网不使用代理，那么你访问的网站就会看到你的公网 IP。

示意图如下

![](https://lh5.googleusercontent.com/RrU5gH1m28mihu1Tn07uq1S_ewEGkwUG6hMc4dxIZ1ty_ripBY_YD8czrHjhFm1wvLuvhKSdKsKReRfnyuplf6VNLCjDWT2kYEAeuJP2kqp1NQW-5OTLv5BP)★普通代理的情形 {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

此处说的代理是广义的，包括VPN、多重代理、等。如果用了代理，你访问的网站看到的公网
IP 实际上是代理服务器的 IP。

示意图如下

![](https://lh6.googleusercontent.com/_vDBj9grCEllpy1TqNH47Q2NKrtgnpAVaRA9NR07ss-L0hnKArdGqVy8EUx1Y2hrF9JoEohmmFz7hJS6izGAJ_4KduZB__CT04WupTVxYeSaiUoUSmSguThd)但是不要高兴得太早，仅仅依靠普通的代理，是远远不够滴！请看下面的例子。

★Flash如何暴露你的公网IP？ {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
--------------------------

比如你在浏览器中设置了代理，那么浏览器确实会通过代理来加载网站的页面。但是，浏览器如果安装了某些插件（最典型的是
Flash），这些插件是可以做到绕过代理，直接去访问目标网站的。

举个例子：

比如你想在某个国内的网盘上传政治敏感文件。因为这个网盘是国产的，你担心网盘服务器会记录你的公网
IP。所以捏，你设置了浏览器的 HTTP
代理，通过翻墙代理来访问这个网盘的页面。

如今的很多网盘是利用 Flash 插件进行文件上传的。而且 Flash
插件在上传文件的时候，往往是不经过浏览器的 HTTP
代理，直接连接网盘服务器。如此一来，你的公网 IP 还是暴露了 :(。

示意图如下

![](https://lh5.googleusercontent.com/U3c3YyxOVlcmq4ItauCLQgblLJm58wL42DxIA7GgX21ALTOCjTNq5fMEPp2FIO4Ta4FDGySGlTUZeF1zfURoxcehF7Tq_qodMc1_BkJT0BA-yhoxiGVMLl2K)★某些国产软件如何暴露你的公网IP？ {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

除了浏览器插件（以Flash为主）会暴露你的公网
IP，还有其它很多国产的网络软件也会暴露你的公网 IP。比较典型的有
QQ、腾讯浏览器、360浏览器、迅雷、等等。

上述这些网络软件虽然都提供了代理的功能。但是，即使你设置了代理，这些软件依然有可能在后台，悄悄地访问自己公司的服务器，传输某些不可告人的信息。而且这些软件访问自家的服务器，往往是绕过代理设置，直接连接——这就会导致你的公网IP暴露。

示意图如下

![](https://lh3.googleusercontent.com/ClasRYO6Mc3DSpQozq1mhXmDdwdwV5gBuuGLBuyKwygXgQTdu20oC1C0v0f_nbCTju2_RF07_6hEyCwO92xl9gUMaG7Qy53XRe2n088DoQVd-Kao9jX48JxB)★单虚拟机的方案 {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

那么，如何避免上述这几种危险的情况捏？首先来看一下”单虚拟机”的方案。

咱们可以把那些有危险的软件安装在虚拟系统（虚拟机A）内，然后把该虚拟唯一的虚拟网卡设置为
Host-Only 模式（关于网卡模式的设置，请看”[这里](http://program-think.blogspot.com/2012/12/system-vm-5.html)“）。由于唯一的虚拟网卡是
Host-Only 模式，所以 虚拟机（Guest
OS）内的任何软件都不可能直接访问外部网络。

那么，如何让这些危险的软件联网呢？你可以在 Host OS
里面安装一个代理软件。虽然这个 Guest OS 无法访问外网，但还是可以访问
Host OS 的，所以也就可以连接到 Host OS
里面的代理软件。然后你设置这些危险软件的 HTTP 代理或 SOCKS
代理，让它们通过代理连接到互联网。

示意图如下

![](https://lh3.googleusercontent.com/nsBqpeGBIbDHAPUNB8z4rQIsrPswife7C3Mbphx2q-okjFvXduv721o4-DLddJDy8uZkZTuNgvvYHjTfxQVl3dkENlUtg1yFBSPYYOJr95-faM6EJ_T1wGqj)★双虚拟机的方案 {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

说完”单虚拟机方案”，再来说说”双虚拟机方案”。

对很多网友而言，单虚拟机已经足够了。那么为啥俺还要介绍双虚拟机捏？主要有如下几方面考虑

1、某些翻墙代理软件不是开源的，有些网友对这类软件不放心

2、某些网友的 Host OS 不是 Windows，但是很多翻墙代理是 Windows 软件

所以，咱们可以在”单虚拟机”的基础上再扩展一下，把代理软件也放到虚拟机中（下图的虚拟机B）。虚拟机B
的网卡很有讲究滴——必须是双网卡。一个网卡设置为 Host-Only
模式，以便跟虚拟机 A对接；另一个网卡设置为 NAT 模式，以便访问外网。

示意图如下

![](https://lh3.googleusercontent.com/PWo748Bh31Gh33iYDivqvUYqZjPRtMQKDjO6cc-BJIc1JDkhx4XuEKa3WrBXMh4McZ_o1Qfw4xxqNDMh5FeNTT-uBheUcjrezCiYMrmMlHvGZCgqJ9nVZadm)★结合多重代理 {style="color: black; direction: ltr; font-family: "Arial"; font-size: 18pt; font-weight: bold; line-height: 1.0; margin-bottom: 0; margin-left: 7.5pt; margin-right: 7.5pt; margin-top: 0; padding-bottom: 11.2pt; padding-left: 0; padding-right: 0; padding-top: 0pt; text-align: left;"}
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

在本系列的前一篇，俺介绍了”[用多重代理保持匿名](http://program-think.blogspot.com/2012/03/howto-cover-your-tracks-5.html)“。今天介绍的这2个招数都可以跟多重代理搭配

打个比方，假设你用 “TOR+世界通” 来构造多重代理。对于单虚拟机的方案，你把
TOR 和世界通都安装到 Host OS 即可；对于双虚拟机的方案，你把 TOR
和世界通都安装到 虚拟机B 即可。

[回到本系列的目录](http://program-think.blogspot.com/2010/04/howto-cover-your-tracks-0.html#index)![](https://lh4.googleusercontent.com/onyQSjAVgWG5cx_wzrkqPJQQeaORzunupjyP5ZZzQCUSgrzv0m4ET2KCEjNGy62xWwafVo-haT14HerBPEDY14zDBXG3yTd8fyZHup2Hhlvqe87JTffdluE2)

本文由自动聚合程序取自网络，内容和观点不代表数字时代立场

[墙外新闻实时更新 欢迎订阅数字时代](http://eepurl.com/msuvD)

[](http://eepurl.com/msuvD)

* * * * *

© Chinese Netizens for [中国数字时代](https://caonima.biz/chinese),
2013. |
[Permalink](https://caonima.biz/chinese/2013/01/%e7%bc%96%e7%a8%8b%e9%9a%8f%e6%83%b3-%e5%a6%82%e4%bd%95%e9%9a%90%e8%97%8f%e4%bd%a0%e7%9a%84%e8%b8%aa%e8%bf%b9%ef%bc%8c%e9%81%bf%e5%85%8d%e8%b7%a8%e7%9c%81%e8%bf%bd%e6%8d%956%ef%bc%9a%e7%94%a8/) |
[No
comment](https://caonima.biz/chinese/2013/01/%e7%bc%96%e7%a8%8b%e9%9a%8f%e6%83%b3-%e5%a6%82%e4%bd%95%e9%9a%90%e8%97%8f%e4%bd%a0%e7%9a%84%e8%b8%aa%e8%bf%b9%ef%bc%8c%e9%81%bf%e5%85%8d%e8%b7%a8%e7%9c%81%e8%bf%bd%e6%8d%956%ef%bc%9a%e7%94%a8/#comments) |
Add to
[del.icio.us](http://del.icio.us/post?url=https://caonima.biz/chinese/2013/01/%E7%BC%96%E7%A8%8B%E9%9A%8F%E6%83%B3-%E5%A6%82%E4%BD%95%E9%9A%90%E8%97%8F%E4%BD%A0%E7%9A%84%E8%B8%AA%E8%BF%B9%EF%BC%8C%E9%81%BF%E5%85%8D%E8%B7%A8%E7%9C%81%E8%BF%BD%E6%8D%956%EF%BC%9A%E7%94%A8/&title=%E7%BC%96%E7%A8%8B%E9%9A%8F%E6%83%B3+%7C+%E5%A6%82%E4%BD%95%E9%9A%90%E8%97%8F%E4%BD%A0%E7%9A%84%E8%B8%AA%E8%BF%B9%EF%BC%8C%E9%81%BF%E5%85%8D%E8%B7%A8%E7%9C%81%E8%BF%BD%E6%8D%95%5B6%5D%EF%BC%9A%E7%94%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%9A%90%E5%8C%BF%E5%85%AC%E7%BD%91IP)

Post tags:
[公共知识分子](https://caonima.biz/chinese/tag/%e5%85%ac%e5%85%b1%e7%9f%a5%e8%af%86%e5%88%86%e5%ad%90/?category=10466),
[跨省追捕](https://caonima.biz/chinese/tag/%e8%b7%a8%e7%9c%81%e8%bf%bd%e6%8d%95/?category=10466),
[防火长城](https://caonima.biz/chinese/tag/%e9%98%b2%e7%81%ab%e9%95%bf%e5%9f%8e/?category=10466)

订靠谱新闻 获穿墙捷径
请发电邮(最好用gmail)至：[sub@chinadigitaltimes.net](mailto:sub@chinadigitaltimes.net)

![](https://lh6.googleusercontent.com/xsq082EMaa5PuKVNXqlnZGEDXeCyMF7iTr5ut5q5ivv6ZmXJQA2_gWdnavDRBGQ5yXRSvVrkrt0IxSOfo9gVGW9WMaaJyIeKryqe1-m7BeLr6Ery1b7Zjt7Q) ![](https://lh6.googleusercontent.com/myWa8X2Wurb1ebm213EzJtBMNlx0LstLhQ0X3yhnUwyNOFuaYNq9KYRSqFXFZd_hYfx69RoBTwivhnsFiHoo372Ecz4N3BhYisuo9M9uBxKkCnxrxnzolFs4) ![](https://lh5.googleusercontent.com/uZkxG3hHYDecNplv4snSEYlr04AExmlYVgZEDOfPLX_jtZJUTIfFVy0CwcZbOKtVCef8K-wTvwedxjx1wvkx5Fk76OnIy49uKzLuul0cb996n-j3nI6-SQ7g) ![](https://lh3.googleusercontent.com/kxcMyywnuh_suV_qM-mqeQL7NEU4WLabL6_JtLToVRee0wRtG5kTk_KJae7Y5pjc5777RI9fK1BZ_2HOw487rLxj3JdJR2teyAE0pR3GmElJ4lCA9gb_7_yL) ![](https://lh6.googleusercontent.com/q778yET_iEjF0EDi2ub2askgFZlo02yXv-cmbEYdkGWAVGH-g6sBq6gUFV09dN1XVfzipRjIn_BEFpxxpk50ppCf_meVYi8Blu5Yk89kCPORIl-fe3QwFp33) ![](https://lh4.googleusercontent.com/uUcd_KayQCD1Yetluz_EJMxWo2l2EGXqDOzP18hCtVAPmuUjSNj9uDunufkCsk1civ8RyL8thwJQ68LGezg9-hXYTD_yClyxCnUOCE0hcR3RDm7uaX0Unt5i) ![](https://lh5.googleusercontent.com/JuZ7N9xofj7i-j6HSveFWknP7-8Yce8cw52pOa24vgnRY5NAL-cJ4NLgxUv3k0GpSrmvWMtqJ8y3mNLbTDx8uKmvF_z0JamhWvd3FTavF97LlhyzxbFdbw_e) ![](https://lh5.googleusercontent.com/JHnIrTwv5kxxdvIo2iyUrt-OkuwlkzUupWvw3qPG9b6Zuev76nsbEGprR55HnJXNC6bvT6wYLm7pBEHrpj9lAhtB5Ge8hD_JH9RhMVeRCCDsn7uPG7S2KeE0)
